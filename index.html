<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USINFOCO</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="icon.png" type="image/png">
</head>
<body>
    <div class="main-wrapper">
        <div class="container">
            <img src="logo.png" alt="Logo da Empresa" class="logo">
            <h1>Ordem de Serviço / Orçamento - Usinagem </h1>

            <div class="company-info">
                <p><strong>Endereço:</strong> <span id="companyAddress">Seu Endereço, 123 - Sua Cidade, SP</span></p>
                <p><strong>CNPJ:</strong> <span id="companyCnpj">XX.XXX.XXX/XXXX-XX</span></p>
                <p><strong>PIX:</strong> <span id="companyPix">suachavepix@email.com ou (xx) xxxxx-xxxx</span></p>
            </div>

            <div class="input-group">
                <label for="numeroOrcamento">Número do Orçamento:</label>
                <input type="text" id="numeroOrcamento" placeholder="Ex: ORC001/2024">
            </div>

            <div class="input-group">
                <label for="nomeCliente">Nome do Cliente:</label>
                <input type="text" id="nomeCliente" placeholder="Nome Completo ou Razão Social">
            </div>

            <div class="input-group">
                <label for="dataOrcamento">Data do Orçamento:</label>
                <input type="date" id="dataOrcamento">
            </div>

            <div class="input-group">
                <label for="tempoProgramacao">Tempo de Programação (Minutos):</label>
                <input type="number" id="tempoProgramacao" step="0.01" min="0" value="0" placeholder="Ex: 0.5">
            </div>

            <div class="input-group">
                <label for="custoHora">Custo da Máquina por Minuto (R$):</label>
                <input type="number" id="custoHora" step="0.01" min="0">
            </div>

            <h2>Detalhes das Peças</h2>
            <div class="table-container">
                <table id="itensTable">
                    <thead>
                        <tr>
                            <th>Qtd.</th>
                            <th>Peça</th>
                            <th>Largura (mm)</th>
                            <th>Altura (mm)</th>
                            <th>Tempo Unit. (min)</th>
                            <th>Valor Unit. (R$)</th>
                            <th>Tempo Total (min)</th>
                            <th>Valor Total (R$)</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <button id="addRowBtn" class="add-row-button">Adicionar Linha</button>

            <div class="total-summary">
                <p>Subtotal Peças: <span id="subtotalPecas">R$ 0.00</span></p>
                <p>Custo Programação: <span id="custoProgramacao">R$ 0.00</span></p>
            </div>
            
            <div class="input-group discount-input-group">
                <label for="percentualDesconto">Desconto em Percentual (%):</label>
                <input type="number" id="percentualDesconto" step="0.01" min="0" max="100" value="0" placeholder="Ex: 5.50">
            </div>
            <div class="input-group discount-input-group">
                <label for="valorDescontoFixo">Desconto em Reais (R$):</label>
                <input type="number" id="valorDescontoFixo" step="0.01" min="0" value="0.00" placeholder="Ex: 100.00">
            </div>
            
            <div class="resultado-calculo">
                <h2>Valor Total Sem Desconto:</h2>
                <p id="valorTotalCalculado">R$ 0.00</p>
                <p class="valor-desconto-aplicado">Desconto Aplicado: <span id="valorDescontoAplicado">R$ 0.00</span></p>
                <p class="valor-com-desconto">Valor Total Final: <span id="valorTotalComDesconto">R$ 0.00</span></p>
            </div>

            <button id="gerarOrcamentoBtn" class="secondary-action-button">Gerar Orçamento (Nova Janela)</button>
            <button id="exportExcelBtn" class="export-button">Exportar para Excel</button>
            <button id="abrirCalculadoraBtn" class="calculator-button">Abrir Calculadora de Tempo</button>
        </div>
        <div class="footer-partnership">
            <p>Parceria com:</p>
            <img src="gmobile_logo.png" alt="Logo Gmobile" class="gmobile-logo">
        </div>

    </div>
    <script src="script.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</body>
</html>
